Epoch 0/1
----------
tensor(2.9127, device='cuda:0', grad_fn=<NllLossBackward>)
































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.19it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 17/20 [00:03<00:00,  4.45it/s]
valid Loss: 0.93 Acc: 76.9 F1 : 0.60
==> best model saved - 0 / 76.9
Epoch 1/1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.25it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:04<00:00,  4.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.19it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 17/20 [00:03<00:00,  4.77it/s]
valid Loss: 0.75 Acc: 82.2 F1 : 0.68
==> best model saved - 1 / 82.2
Best valid Acc: 1 - 82.2
Best valid F1: 1 - 82.2
model saved
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/correct31_0_2...   31       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
1          /opt/ml/newinput/UTKFace_revised/lipsk27_1_2_2...   27       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
2          /opt/ml/newinput/UTKFace_revised/77_0_2_201701...   77       0     14  /opt/ml/input/data/train/UTKFace_revised/77_0_...      2     14
3          /opt/ml/newinput/UTKFace_revised/correct32_0_2...   32       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
4          /opt/ml/newinput/UTKFace_revised/lipsk68_0_2_2...   68       0      8  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      8
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/correct26_0_2...   26       0      0  /opt/ml/input/data/train/UTKFace_revised/corre...      0      0
1          /opt/ml/newinput/UTKFace_revised/correct32_1_2...   32       1      4  /opt/ml/input/data/train/UTKFace_revised/corre...      0      4
2          /opt/ml/newinput/UTKFace_revised/90_1_2_201701...   90       1     17  /opt/ml/input/data/train/UTKFace_revised/90_1_...      2     17
3          /opt/ml/newinput/UTKFace_revised/chinsk59_1_2_...   59       1     10  /opt/ml/input/data/train/UTKFace_revised/chins...      1     10
4          /opt/ml/newinput/UTKFace_revised/26_0_2_201701...   26       0     12  /opt/ml/input/data/train/UTKFace_revised/26_0_...      2     12
6675 3289
Epoch 0/2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.53it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.07it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]



 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:06<00:00, 12.15it/s]
valid Loss: 0.78 Acc: 71.5 F1 : 0.54
==> best model saved - 0 / 71.5
Epoch 1/2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:07<00:00,  7.25it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.97it/s]
  2%|███▌                                                                                                                                                                                   | 1/52 [00:01<01:35,  1.87s/it]


 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 49/52 [00:05<00:00, 12.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.54it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
==> best model saved - 1 / 81.5
Epoch 2/2
----------












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.99it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

  6%|██████████▌                                                                                                                                                                            | 3/52 [00:02<01:24,  1.72s/it]


 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 47/52 [00:06<00:00, 12.09it/s]
valid Loss: 1.14 Acc: 64.4 F1 : 0.54
Best valid Acc: 1 - 81.5
Best valid F1: 1 - 81.5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:07<00:00,  6.97it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/correct26_0_2...   26       0      0  /opt/ml/input/data/train/UTKFace_revised/corre...      0      0
1          /opt/ml/newinput/UTKFace_revised/lipsk27_1_2_2...   27       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
2          /opt/ml/newinput/UTKFace_revised/correct22_1_2...   22       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
3          /opt/ml/newinput/UTKFace_revised/correct30_0_2...   30       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
4          /opt/ml/newinput/UTKFace_revised/chinsk26_1_2_...   26       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/40_0_2_201701...   40       0     13  /opt/ml/input/data/train/UTKFace_revised/40_0_...      2     13
1          /opt/ml/newinput/UTKFace_revised/correct53_1_2...   53       1      4  /opt/ml/input/data/train/UTKFace_revised/corre...      0      4
2          /opt/ml/newinput/UTKFace_revised/correct27_1_2...   27       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
3          /opt/ml/newinput/UTKFace_revised/30_1_2_201701...   30       1     16  /opt/ml/input/data/train/UTKFace_revised/30_1_...      2     16
4          /opt/ml/newinput/UTKFace_revised/30_0_2_201701...   30       0     13  /opt/ml/input/data/train/UTKFace_revised/30_0_...      2     13
6675 3289
Epoch 0/1












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.97it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]



 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:08<00:00,  9.22it/s]
valid Loss: 2.17 Acc: 0.0 F1 : 0.00
Epoch 1/1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:09<00:00,  5.73it/s]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:27<00:00,  3.87it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]



 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:08<00:00,  9.23it/s]
valid Loss: 2.03 Acc: 0.0 F1 : 0.00
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:09<00:00,  5.73it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/22_0_2_201701...   22       0     12  /opt/ml/input/data/train/UTKFace_revised/22_0_...      2     12
1          /opt/ml/newinput/UTKFace_revised/lipsk26_1_2_2...   26       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
2          /opt/ml/newinput/UTKFace_revised/chinsk26_1_2_...   26       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
3          /opt/ml/newinput/UTKFace_revised/lipsk25_1_2_2...   25       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
4          /opt/ml/newinput/UTKFace_revised/26_0_2_201701...   26       0     12  /opt/ml/input/data/train/UTKFace_revised/26_0_...      2     12
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk30_0_2_...   30       0      7  /opt/ml/input/data/train/UTKFace_revised/chins...      1      7
1          /opt/ml/newinput/UTKFace_revised/lipsk40_0_2_2...   40       0      7  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      7
2          /opt/ml/newinput/UTKFace_revised/lipsk35_0_2_2...   35       0      7  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      7
3          /opt/ml/newinput/UTKFace_revised/chinsk86_1_2_...   86       1     11  /opt/ml/input/data/train/UTKFace_revised/chins...      1     11
4          /opt/ml/newinput/UTKFace_revised/correct28_1_2...   28       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
6675 3289
Epoch 0/2
----------












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.03it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

 17%|███████████████████████████████▋                                                                                                                                                       | 9/52 [00:02<00:24,  1.76it/s]


 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:06<00:00, 12.14it/s]
valid Loss: 0.36 Acc: 87.2 F1 : 0.79
==> best model saved - 0 / 87.2
Epoch 1/2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:07<00:00,  7.28it/s]
  1%|█▋                                                                                                                                                                                    | 1/105 [00:01<02:50,  1.64s/it]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.99it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.51it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 0.45 Acc: 85.0 F1 : 0.77
Epoch 2/2

  4%|██████▉                                                                                                                                                                               | 4/105 [00:02<01:17,  1.30it/s]











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.98it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

  2%|███▌                                                                                                                                                                                   | 1/52 [00:02<01:52,  2.20s/it]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:07<00:00,  7.23it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
valid Loss: 0.57 Acc: 79.5 F1 : 0.74
Best valid Acc: 0 - 87.2
Best valid F1: 0 - 87.2
model saved
           id  gender   race  age                  path                file  value  score
0      000613       0  Asian    1  000613_male_Asian_51           mask1.jpg      0      1
1      000613       0  Asian    1  000613_male_Asian_51           mask2.jpg      0      1
2      000613       0  Asian    1  000613_male_Asian_51           mask4.jpg      0      1
3      000613       0  Asian    1  000613_male_Asian_51          normal.jpg      2     13
4      000613       0  Asian    1  000613_male_Asian_51           mask5.jpg      0      1
...       ...     ...    ...  ...                   ...                 ...    ...    ...
17642  001019       0  Asian    0  001019_male_Asian_29           mask4.jpg      0      0
17643  001019       0  Asian    0  001019_male_Asian_29          normal.jpg      2     12
17644  001019       0  Asian    0  001019_male_Asian_29           mask5.jpg      0      0
17645  001019       0  Asian    0  001019_male_Asian_29           mask3.jpg      0      0
17646  001019       0  Asian    0  001019_male_Asian_29  incorrect_mask.jpg      1      6
[17647 rows x 8 columns]
          id  gender   race  age                    path                file  value  score
0     003102       1  Asian    0  003102_female_Asian_20           mask1.jpg      0      3
1     003102       1  Asian    0  003102_female_Asian_20           mask2.jpg      0      3
2     003102       1  Asian    0  003102_female_Asian_20           mask4.jpg      0      3
3     003102       1  Asian    0  003102_female_Asian_20          normal.jpg      2     15
4     003102       1  Asian    0  003102_female_Asian_20           mask5.jpg      0      3
...      ...     ...    ...  ...                     ...                 ...    ...    ...
1248  004424       0  Asian    0    004424_male_Asian_19           mask4.jpg      0      0
1249  004424       0  Asian    0    004424_male_Asian_19          normal.jpg      2     12
1250  004424       0  Asian    0    004424_male_Asian_19           mask5.jpg      0      0
1251  004424       0  Asian    0    004424_male_Asian_19           mask3.jpg      0      0
1252  004424       0  Asian    0    004424_male_Asian_19  incorrect_mask.jpg      1      6
[1253 rows x 8 columns]
17647 1253
Epoch 0/1
----------
































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.21it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 45%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                    | 9/20 [00:03<00:06,  1.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.18it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
valid Loss: 0.19 Acc: 93.7 F1 : 0.89
==> best model saved - 0 / 93.7
Epoch 1/1

  1%|█▎                                                                                                                                                                                    | 2/276 [00:02<06:43,  1.47s/it]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:06<00:00,  4.17it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 25%|█████████████████████████████████████████████▊                                                                                                                                         | 5/20 [00:02<00:16,  1.12s/it]

 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 19/20 [00:03<00:00,  5.63it/s]
valid Loss: 0.25 Acc: 93.5 F1 : 0.88
Best valid Acc: 0 - 93.7

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.25it/s]
model saved