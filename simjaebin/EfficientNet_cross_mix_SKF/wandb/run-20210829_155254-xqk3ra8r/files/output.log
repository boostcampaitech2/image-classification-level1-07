Epoch 0/1
----------
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]































 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████  | 273/276 [01:04<00:00,  4.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.21it/s]

 25%|█████████████████████████████████████████████▊                                                                                                                                         | 5/20 [00:02<00:16,  1.13s/it]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.26it/s]
valid Loss: 0.37 Acc: 86.3 F1 : 0.79
==> best model saved - 0 / 86.3
Epoch 1/1
----------
  0%|▋                                                                                                                                                                                     | 1/276 [00:01<08:04,  1.76s/it]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.20it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]
train Loss: 0.12 Acc: 95.7 F1 : 0.90


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.61it/s]
valid Loss: 0.39 Acc: 89.0 F1 : 0.82
==> best model saved - 1 / 89.0
Best valid Acc: 1 - 89.0
Best valid F1: 1 - 89.0
model saved
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk24_1_2_...   24       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
1          /opt/ml/newinput/UTKFace_revised/chinsk88_0_2_...   88       0      8  /opt/ml/input/data/train/UTKFace_revised/chins...      1      8
2          /opt/ml/newinput/UTKFace_revised/lipsk21_1_2_2...   21       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
3          /opt/ml/newinput/UTKFace_revised/correct25_1_2...   25       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
4          /opt/ml/newinput/UTKFace_revised/chinsk45_0_2_...   45       0      7  /opt/ml/input/data/train/UTKFace_revised/chins...      1      7
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/26_1_2_201701...   26       1     15  /opt/ml/input/data/train/UTKFace_revised/26_1_...      2     15
1          /opt/ml/newinput/UTKFace_revised/correct26_0_2...   26       0      0  /opt/ml/input/data/train/UTKFace_revised/corre...      0      0
2          /opt/ml/newinput/UTKFace_revised/chinsk40_1_2_...   40       1     10  /opt/ml/input/data/train/UTKFace_revised/chins...      1     10
3          /opt/ml/newinput/UTKFace_revised/correct58_0_2...   58       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
4          /opt/ml/newinput/UTKFace_revised/72_0_2_201701...   72       0     14  /opt/ml/input/data/train/UTKFace_revised/72_0_...      2     14
6675 3289
Epoch 0/2
----------
  1%|█▋                                                                                                                                                                                    | 1/105 [00:01<02:34,  1.48s/it]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.03it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]


 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 47/52 [00:05<00:00, 12.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.62it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
==> best model saved - 0 / 66.5
Epoch 1/2
----------












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.01it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]
train Loss: 0.45 Acc: 82.9 F1 : 0.75


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.95it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 0.80 Acc: 71.7 F1 : 0.58
==> best model saved - 1 / 71.7
Epoch 2/2

  3%|█████▏                                                                                                                                                                                | 3/105 [00:02<01:40,  1.02it/s]











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.03it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

 17%|███████████████████████████████▋                                                                                                                                                       | 9/52 [00:02<00:17,  2.47it/s]


 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:05<00:00, 12.34it/s]
valid Loss: 0.67 Acc: 78.4 F1 : 0.68
==> best model saved - 2 / 78.4
Best valid Acc: 2 - 78.4
Best valid F1: 2 - 78.4
model saved
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/82_0_2_201701...   82       0     14  /opt/ml/input/data/train/UTKFace_revised/82_0_...      2     14
1          /opt/ml/newinput/UTKFace_revised/correct39_0_2...   39       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
2          /opt/ml/newinput/UTKFace_revised/chinsk26_1_2_...   26       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
3          /opt/ml/newinput/UTKFace_revised/lipsk26_0_2_2...   26       0      6  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      6
4          /opt/ml/newinput/UTKFace_revised/lipsk29_0_2_2...   29       0      6  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      6
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/correct78_0_2...   78       0      2  /opt/ml/input/data/train/UTKFace_revised/corre...      0      2
1          /opt/ml/newinput/UTKFace_revised/chinsk22_1_2_...   22       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
2          /opt/ml/newinput/UTKFace_revised/chinsk25_1_2_...   25       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
3          /opt/ml/newinput/UTKFace_revised/chinsk23_1_2_...   23       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
4          /opt/ml/newinput/UTKFace_revised/lipsk26_0_2_2...   26       0      6  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      6
6675 3289
Epoch 0/1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  8.09it/s]












 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 103/105 [00:25<00:00,  4.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.99it/s]



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:08<00:00,  5.82it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 2.17 Acc: 0.0 F1 : 0.00
Epoch 1/1













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  5.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.97it/s]



 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:07<00:00,  7.89it/s]
valid Loss: 1.94 Acc: 0.0 F1 : 0.00
model saved
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/lipsk19_0_2_2...   19       0      6  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      6
1          /opt/ml/newinput/UTKFace_revised/26_1_2_201701...   26       1     15  /opt/ml/input/data/train/UTKFace_revised/26_1_...      2     15
2          /opt/ml/newinput/UTKFace_revised/chinsk30_1_2_...   30       1     10  /opt/ml/input/data/train/UTKFace_revised/chins...      1     10
3          /opt/ml/newinput/UTKFace_revised/correct46_0_2...   46       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
4          /opt/ml/newinput/UTKFace_revised/correct30_0_2...   30       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/lipsk25_1_2_2...   25       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
1          /opt/ml/newinput/UTKFace_revised/chinsk58_0_2_...   58       0      7  /opt/ml/input/data/train/UTKFace_revised/chins...      1      7
2          /opt/ml/newinput/UTKFace_revised/chinsk56_0_2_...   56       0      7  /opt/ml/input/data/train/UTKFace_revised/chins...      1      7
3          /opt/ml/newinput/UTKFace_revised/40_0_2_201701...   40       0     13  /opt/ml/input/data/train/UTKFace_revised/40_0_...      2     13
4          /opt/ml/newinput/UTKFace_revised/lipsk40_1_2_2...   40       1     10  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1     10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:08<00:00,  6.26it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
Epoch 0/2
----------












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:24<00:00,  5.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.09it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:07<00:00,  7.13it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 0.38 Acc: 87.4 F1 : 0.82
==> best model saved - 0 / 87.4
Epoch 1/2

  4%|██████▉                                                                                                                                                                               | 4/105 [00:02<01:09,  1.45it/s]











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.03it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

 15%|████████████████████████████▏                                                                                                                                                          | 8/52 [00:02<00:19,  2.25it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:05<00:00, 12.87it/s]
valid Loss: 0.90 Acc: 71.3 F1 : 0.63
Epoch 2/2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.91it/s]
  4%|██████▉                                                                                                                                                                               | 4/105 [00:01<00:55,  1.83it/s]











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.10it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

 15%|████████████████████████████▏                                                                                                                                                          | 8/52 [00:02<00:18,  2.43it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:05<00:00, 12.93it/s]
valid Loss: 0.24 Acc: 91.9 F1 : 0.87
==> best model saved - 2 / 91.9
Best valid Acc: 2 - 91.9
Best valid F1: 2 - 91.9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.85it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
           id  gender   race  age                  path                file  value  score
0      006724       0  Asian    0  006724_male_Asian_19           mask1.jpg      0      0
1      006724       0  Asian    0  006724_male_Asian_19           mask2.jpg      0      0
2      006724       0  Asian    0  006724_male_Asian_19           mask4.jpg      0      0
3      006724       0  Asian    0  006724_male_Asian_19          normal.jpg      2     12
4      006724       0  Asian    0  006724_male_Asian_19           mask5.jpg      0      0
...       ...     ...    ...  ...                   ...                 ...    ...    ...
17642  003543       0  Asian    1  003543_male_Asian_55           mask4.jpg      0      1
17643  003543       0  Asian    1  003543_male_Asian_55          normal.jpg      2     13
17644  003543       0  Asian    1  003543_male_Asian_55           mask5.jpg      0      1
17645  003543       0  Asian    1  003543_male_Asian_55           mask3.jpg      0      1
17646  003543       0  Asian    1  003543_male_Asian_55  incorrect_mask.jpg      1      7
[17647 rows x 8 columns]
          id  gender   race  age                    path                file  value  score
0     006717       0  Asian    0    006717_male_Asian_19           mask1.jpg      0      0
1     006717       0  Asian    0    006717_male_Asian_19           mask2.jpg      0      0
2     006717       0  Asian    0    006717_male_Asian_19           mask4.jpg      0      0
3     006717       0  Asian    0    006717_male_Asian_19          normal.jpg      2     12
4     006717       0  Asian    0    006717_male_Asian_19           mask5.jpg      0      0
...      ...     ...    ...  ...                     ...                 ...    ...    ...
1248  000026       1  Asian    1  000026_female_Asian_56           mask4.jpg      0      4
1249  000026       1  Asian    1  000026_female_Asian_56          normal.jpg      2     16
1250  000026       1  Asian    1  000026_female_Asian_56           mask5.jpg      0      4
1251  000026       1  Asian    1  000026_female_Asian_56           mask3.jpg      0      4
1252  000026       1  Asian    1  000026_female_Asian_56  incorrect_mask.jpg      1     10
[1253 rows x 8 columns]
17647 1253
Epoch 0/1
----------
































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:04<00:00,  4.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.21it/s]
  5%|█████████▏                                                                                                                                                                             | 1/20 [00:01<00:30,  1.59s/it]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.56it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
valid Loss: 0.39 Acc: 88.3 F1 : 0.81
==> best model saved - 0 / 88.3
Epoch 1/1

  2%|███▉                                                                                                                                                                                  | 6/276 [00:03<02:30,  1.79it/s]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.18it/s]
 20%|████████████████████████████████████▌                                                                                                                                                  | 4/20 [00:01<00:10,  1.59it/s]
train Loss: 0.05 Acc: 98.5 F1 : 0.97


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.19it/s]
valid Loss: 0.33 Acc: 90.3 F1 : 0.81
==> best model saved - 1 / 90.3
Best valid Acc: 1 - 90.3
Best valid F1: 1 - 90.3
model saved