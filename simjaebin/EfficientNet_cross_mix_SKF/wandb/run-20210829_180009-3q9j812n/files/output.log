Epoch 0/1
----------
tensor(2.8891, device='cuda:0', grad_fn=<NllLossBackward>)






























100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [01:03<00:00,  4.17it/s]
  0%|                                                                                                                                                                                               | 0/30 [00:00<?, ?it/s]
train Loss: 0.52 Acc: 83.5 F1 : 0.70


 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 28/30 [00:04<00:00,  9.57it/s]
valid Loss: 0.50 Acc: 83.9 F1 : 0.75
==> best model saved - 0 / 83.9
Epoch 1/1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:05<00:00,  5.52it/s]
  0%|                                                                                                                                                                                              | 0/266 [00:00<?, ?it/s]































100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 265/266 [01:03<00:00,  4.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [01:04<00:00,  4.15it/s]
  0%|                                                                                                                                                                                               | 0/30 [00:00<?, ?it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:04<00:00, 10.74it/s]
valid Loss: 0.18 Acc: 93.6 F1 : 0.86
==> best model saved - 1 / 93.6
Best valid Acc: 1 - 93.6
Best valid F1: 1 - 93.6
model saved
                                                        path  age  gender  class                                               file  value
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk61_0_2_...   61       0      8  /opt/ml/input/data/train/UTKFace_revised/chins...      1
1          /opt/ml/newinput/UTKFace_revised/lipsk79_0_2_2...   79       0      8  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1
2          /opt/ml/newinput/UTKFace_revised/lipsk39_0_2_2...   39       0      7  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1
3          /opt/ml/newinput/UTKFace_revised/correct26_1_2...   26       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0
4          /opt/ml/newinput/UTKFace_revised/lipsk32_1_2_2...   32       1     10  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1
                                                        path  age  gender  class                                               file  value
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk28_1_2_...   28       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1
1          /opt/ml/newinput/UTKFace_revised/correct30_1_2...   30       1      4  /opt/ml/input/data/train/UTKFace_revised/corre...      0
2          /opt/ml/newinput/UTKFace_revised/chinsk39_1_2_...   39       1     10  /opt/ml/input/data/train/UTKFace_revised/chins...      1
3          /opt/ml/newinput/UTKFace_revised/lipsk23_1_2_2...   23       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1
4          /opt/ml/newinput/UTKFace_revised/correct35_0_2...   35       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0
8856 1108
Epoch 0/2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:05<00:00,  5.56it/s]
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:15: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['file'] = name_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:16: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['value'] = value_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:76: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['new_index'] = [i for i in range(len(self.df))]
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:15: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['file'] = name_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:16: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['value'] = value_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:76: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['new_index'] = [i for i in range(len(self.df))]
  0%|                                                                                                                                                                                              | 0/139 [00:00<?, ?it/s]
















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:32<00:00,  4.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:33<00:00,  4.16it/s]
  0%|                                                                                                                                                                                               | 0/18 [00:00<?, ?it/s]

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 17/18 [00:02<00:00,  5.76it/s]
valid Loss: 1.01 Acc: 57.6 F1 : 0.49
==> best model saved - 0 / 57.6
Epoch 1/2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:03<00:00,  4.64it/s]
  0%|                                                                                                                                                                                              | 0/139 [00:00<?, ?it/s]
















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:33<00:00,  4.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:33<00:00,  4.09it/s]
  6%|██████████▏                                                                                                                                                                            | 1/18 [00:01<00:26,  1.58s/it]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:03<00:00,  4.82it/s]
valid Loss: 0.80 Acc: 74.5 F1 : 0.59
==> best model saved - 1 / 74.5
Epoch 2/2
----------
  1%|██▌                                                                                                                                                                                   | 2/139 [00:01<02:42,  1.19s/it]















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:34<00:00,  4.09it/s]
  0%|                                                                                                                                                                                               | 0/18 [00:00<?, ?it/s]

 17%|██████████████████████████████▌                                                                                                                                                        | 3/18 [00:02<00:13,  1.11it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:04<00:00,  4.41it/s]
valid Loss: 0.42 Acc: 85.7 F1 : 0.79
==> best model saved - 2 / 85.7
Best valid Acc: 2 - 85.7
Best valid F1: 2 - 85.7
model saved
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk28_1_2_...   28       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
1          /opt/ml/newinput/UTKFace_revised/chinsk61_0_2_...   61       0      8  /opt/ml/input/data/train/UTKFace_revised/chins...      1      8
2          /opt/ml/newinput/UTKFace_revised/lipsk79_0_2_2...   79       0      8  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      8
3          /opt/ml/newinput/UTKFace_revised/correct30_1_2...   30       1      4  /opt/ml/input/data/train/UTKFace_revised/corre...      0      4
4          /opt/ml/newinput/UTKFace_revised/correct26_1_2...   26       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/lipsk39_0_2_2...   39       0      7  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      7
1          /opt/ml/newinput/UTKFace_revised/28_0_2_201701...   28       0     12  /opt/ml/input/data/train/UTKFace_revised/28_0_...      2     12
2          /opt/ml/newinput/UTKFace_revised/lipsk28_1_2_2...   28       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
3          /opt/ml/newinput/UTKFace_revised/correct32_1_2...   32       1      4  /opt/ml/input/data/train/UTKFace_revised/corre...      0      4
4          /opt/ml/newinput/UTKFace_revised/lipsk34_1_2_2...   34       1     10  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1     10
8856 1108
Epoch 0/1
----------
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:15: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['file'] = name_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:16: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['value'] = value_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:129: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['score'] = self.df['class']
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:130: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['new_index'] = [i for i in range(len(self.df))]
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:15: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['file'] = name_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:16: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['value'] = value_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:129: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['score'] = self.df['class']
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:130: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['new_index'] = [i for i in range(len(self.df))]
















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:32<00:00,  4.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:33<00:00,  4.11it/s]

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 17/18 [00:03<00:00,  7.11it/s]
valid Loss: 2.05 Acc: 0.0 F1 : 0.00
Epoch 1/1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:04<00:00,  4.14it/s]
















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:33<00:00,  4.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:34<00:00,  4.07it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:04<00:00,  3.88it/s]
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:15: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['file'] = name_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:16: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['value'] = value_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:76: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['new_index'] = [i for i in range(len(self.df))]
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:15: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['file'] = name_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:16: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  pre_df['value'] = value_list
/opt/ml/code/EfficientNet_cross_level_1/dataset.py:76: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.df['new_index'] = [i for i in range(len(self.df))]
  0%|                                                                                                                                                                                              | 0/139 [00:00<?, ?it/s]
valid Loss: 1.92 Acc: 0.0 F1 : 0.00
model saved
                                                        path  age  gender  class                                               file  value
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk28_1_2_...   28       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1
1          /opt/ml/newinput/UTKFace_revised/chinsk61_0_2_...   61       0      8  /opt/ml/input/data/train/UTKFace_revised/chins...      1
2          /opt/ml/newinput/UTKFace_revised/lipsk79_0_2_2...   79       0      8  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1
3          /opt/ml/newinput/UTKFace_revised/correct30_1_2...   30       1      4  /opt/ml/input/data/train/UTKFace_revised/corre...      0
4          /opt/ml/newinput/UTKFace_revised/lipsk39_0_2_2...   39       0      7  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1
                                                        path  age  gender  class                                               file  value
new_index
0          /opt/ml/newinput/UTKFace_revised/chinsk28_0_2_...   28       0      6  /opt/ml/input/data/train/UTKFace_revised/chins...      1
1          /opt/ml/newinput/UTKFace_revised/correct35_0_2...   35       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0
2          /opt/ml/newinput/UTKFace_revised/28_0_2_201701...   28       0     12  /opt/ml/input/data/train/UTKFace_revised/28_0_...      2
3          /opt/ml/newinput/UTKFace_revised/90_0_2_201701...   90       0     14  /opt/ml/input/data/train/UTKFace_revised/90_0_...      2
4          /opt/ml/newinput/UTKFace_revised/26_1_2_201701...   26       1     15  /opt/ml/input/data/train/UTKFace_revised/26_1_...      2
8856 1108
Epoch 0/2
  2%|███▉                                                                                                                                                                                  | 3/139 [00:01<01:57,  1.16it/s]
  2%|███▉                                                                                                                                                                                  | 3/139 [00:01<01:57,  1.16it/s]
  9%|███████████████▋                                                                                                                                                                     | 12/139 [00:04<00:32,  3.94it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
train Loss: 0.12 Acc: 95.8 F1 : 0.93
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(0.1683, device='cuda:0')
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
valid Loss: 0.24 Acc: 91.1 F1 : 0.88
==> best model saved - 0 / 91.1
Epoch 1/2
----------
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(0.1932, device='cuda:0', grad_fn=<NllLossBackward>)
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
train Loss: 0.09 Acc: 97.0 F1 : 0.95
tensor(0.1089, device='cuda:0')
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
valid Loss: 0.16 Acc: 95.1 F1 : 0.93
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
==> best model saved - 1 / 95.1
Epoch 2/2
----------
tensor(0.0254, device='cuda:0', grad_fn=<NllLossBackward>)
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
train Loss: 0.04 Acc: 98.7 F1 : 0.98
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(0.1097, device='cuda:0')
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
valid Loss: 0.05 Acc: 98.1 F1 : 0.95
==> best model saved - 2 / 98.1
Best valid Acc: 2 - 98.1
Best valid F1: 2 - 98.1
model saved
               id  gender   race  age                    path        file  value  class
new_index
0          000001       1  Asian    1  000001_female_Asian_45   mask1.jpg      0      4
1          000001       1  Asian    1  000001_female_Asian_45   mask2.jpg      0      4
2          000001       1  Asian    1  000001_female_Asian_45   mask4.jpg      0      4
3          000001       1  Asian    1  000001_female_Asian_45  normal.jpg      2     16
4          000001       1  Asian    1  000001_female_Asian_45   mask5.jpg      0      4
               id  gender   race  age                    path                file  value  class
new_index
0          000006       1  Asian    1  000006_female_Asian_59           mask5.jpg      0      4
1          000007       1  Asian    1  000007_female_Asian_58           mask1.jpg      0      4
2          000007       1  Asian    1  000007_female_Asian_58  incorrect_mask.jpg      1     10
3          000012       0  Asian    1    000012_male_Asian_57           mask1.jpg      0      1
4          000012       0  Asian    1    000012_male_Asian_57           mask4.jpg      0      1
17010 1890
Epoch 0/1
----------
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(3.8916, device='cuda:0', grad_fn=<NllLossBackward>)
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
train Loss: 0.22 Acc: 92.8 F1 : 0.86
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(0.0423, device='cuda:0')
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
valid Loss: 0.09 Acc: 97.2 F1 : 0.94
==> best model saved - 0 / 97.2
Epoch 1/1
----------
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(0.0476, device='cuda:0', grad_fn=<NllLossBackward>)
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
train Loss: 0.05 Acc: 98.4 F1 : 0.97
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
tensor(0.0419, device='cuda:0')
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
valid Loss: 0.06 Acc: 97.8 F1 : 0.95
==> best model saved - 1 / 97.8
Best valid Acc: 1 - 97.8
Best valid F1: 1 - 97.8
model saved
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]
 15%|███████████████████████████▎                                                                                                                                                         | 21/139 [00:06<00:27,  4.32it/s]