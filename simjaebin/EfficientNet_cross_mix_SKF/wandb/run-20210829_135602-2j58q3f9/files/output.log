Epoch 0/3
----------
tensor(2.9077, device='cuda:0', grad_fn=<NllLossBackward>)












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  4.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.99it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]


 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                 | 47/52 [00:05<00:00, 12.14it/s]
valid Loss: 1.39 Acc: 49.0 F1 : 0.29
==> best model saved - 0 / 49.0
Epoch 1/3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.70it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.97it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

  6%|██████████▌                                                                                                                                                                            | 3/52 [00:02<01:19,  1.62s/it]


 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:06<00:00, 12.30it/s]
valid Loss: 1.07 Acc: 62.6 F1 : 0.45
==> best model saved - 1 / 62.6
Epoch 2/3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:07<00:00,  7.16it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]












 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 103/105 [00:25<00:00,  4.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.01it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.45it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 0.89 Acc: 72.0 F1 : 0.59
==> best model saved - 2 / 72.0
Epoch 3/3
----------












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.04it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]

 10%|█████████████████▌                                                                                                                                                                     | 5/52 [00:02<00:43,  1.09it/s]


 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:05<00:00, 12.19it/s]
valid Loss: 0.31 Acc: 89.3 F1 : 0.83
==> best model saved - 3 / 89.3
Best valid Acc: 3 - 89.3
Best valid F1: 3 - 89.3
model saved
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/lipsk37_0_2_2...   37       0      7  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      7
1          /opt/ml/newinput/UTKFace_revised/chinsk28_1_2_...   28       1      9  /opt/ml/input/data/train/UTKFace_revised/chins...      1      9
2          /opt/ml/newinput/UTKFace_revised/correct35_0_2...   35       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
3          /opt/ml/newinput/UTKFace_revised/correct41_0_2...   41       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
4          /opt/ml/newinput/UTKFace_revised/correct28_1_2...   28       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
                                                        path  age  gender  class                                               file  value  score
new_index
0          /opt/ml/newinput/UTKFace_revised/correct28_0_2...   28       0      0  /opt/ml/input/data/train/UTKFace_revised/corre...      0      0
1          /opt/ml/newinput/UTKFace_revised/lipsk26_1_2_2...   26       1      9  /opt/ml/input/data/train/UTKFace_revised/lipsk...      1      9
2          /opt/ml/newinput/UTKFace_revised/26_0_2_201701...   26       0     12  /opt/ml/input/data/train/UTKFace_revised/26_0_...      2     12
3          /opt/ml/newinput/UTKFace_revised/correct35_0_2...   35       0      1  /opt/ml/input/data/train/UTKFace_revised/corre...      0      1
4          /opt/ml/newinput/UTKFace_revised/correct24_1_2...   24       1      3  /opt/ml/input/data/train/UTKFace_revised/corre...      0      3
6675 3289
Epoch 0/3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:06<00:00,  7.66it/s]












 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 103/105 [00:24<00:00,  4.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.03it/s]



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:09<00:00,  5.75it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 2.23 Acc: 0.0 F1 : 0.00
Epoch 1/3












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:25<00:00,  5.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.93it/s]



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:08<00:00,  5.89it/s]
  0%|                                                                                                                                                                                              | 0/105 [00:00<?, ?it/s]
valid Loss: 2.00 Acc: 0.0 F1 : 0.00
Epoch 2/3












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  4.02it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]




 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 51/52 [00:08<00:00,  8.68it/s]
valid Loss: 1.85 Acc: 0.0 F1 : 0.00
Epoch 3/3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:08<00:00,  5.80it/s]












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105/105 [00:26<00:00,  3.93it/s]
  0%|                                                                                                                                                                                               | 0/52 [00:00<?, ?it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:08<00:00,  6.06it/s]
valid Loss: 1.82 Acc: 0.0 F1 : 0.00
model saved
           id  gender   race  age                    path                file  value  score
0      000589       1  Asian    1  000589_female_Asian_56           mask1.jpg      0      4
1      000589       1  Asian    1  000589_female_Asian_56           mask2.jpg      0      4
2      000589       1  Asian    1  000589_female_Asian_56           mask4.jpg      0      4
3      000589       1  Asian    1  000589_female_Asian_56          normal.jpg      2     16
4      000589       1  Asian    1  000589_female_Asian_56           mask5.jpg      0      4
...       ...     ...    ...  ...                     ...                 ...    ...    ...
17642  005148       0  Asian    1    005148_male_Asian_51           mask4.jpg      0      1
17643  005148       0  Asian    1    005148_male_Asian_51          normal.jpg      2     13
17644  005148       0  Asian    1    005148_male_Asian_51           mask5.jpg      0      1
17645  005148       0  Asian    1    005148_male_Asian_51           mask3.jpg      0      1
17646  005148       0  Asian    1    005148_male_Asian_51  incorrect_mask.jpg      1      7
[17647 rows x 8 columns]
          id  gender   race  age                    path                file  value  score
0     003772       1  Asian    2  003772_female_Asian_60           mask1.jpg      0      5
1     003772       1  Asian    2  003772_female_Asian_60           mask2.jpg      0      5
2     003772       1  Asian    2  003772_female_Asian_60           mask4.jpg      0      5
3     003772       1  Asian    2  003772_female_Asian_60          normal.jpg      2     17
4     003772       1  Asian    2  003772_female_Asian_60           mask5.jpg      0      5
...      ...     ...    ...  ...                     ...                 ...    ...    ...
1248  006362       1  Asian    0  006362_female_Asian_18           mask4.jpg      0      3
1249  006362       1  Asian    0  006362_female_Asian_18          normal.jpg      2     15
1250  006362       1  Asian    0  006362_female_Asian_18           mask5.jpg      0      3
1251  006362       1  Asian    0  006362_female_Asian_18           mask3.jpg      0      3
1252  006362       1  Asian    0  006362_female_Asian_18  incorrect_mask.jpg      1      9
[1253 rows x 8 columns]
17647 1253
Epoch 0/5
----------
  1%|█▎                                                                                                                                                                                    | 2/276 [00:01<05:11,  1.14s/it]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.21it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 25%|█████████████████████████████████████████████▊                                                                                                                                         | 5/20 [00:02<00:16,  1.11s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.35it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
valid Loss: 0.43 Acc: 87.6 F1 : 0.78
==> best model saved - 0 / 87.6
Epoch 1/5

  1%|█▎                                                                                                                                                                                    | 2/276 [00:02<05:59,  1.31s/it]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.21it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 15%|███████████████████████████▍                                                                                                                                                           | 3/20 [00:02<00:28,  1.69s/it]

 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 19/20 [00:04<00:00,  5.54it/s]
valid Loss: 0.75 Acc: 84.3 F1 : 0.73
Epoch 2/5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.03it/s]
  0%|▋                                                                                                                                                                                     | 1/276 [00:01<07:54,  1.73s/it]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.19it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

  5%|█████████▏                                                                                                                                                                             | 1/20 [00:02<00:42,  2.24s/it]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.14it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
valid Loss: 0.77 Acc: 84.4 F1 : 0.74
Epoch 3/5

  2%|███▎                                                                                                                                                                                  | 5/276 [00:03<03:06,  1.45it/s]































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:06<00:00,  4.18it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 45%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                    | 9/20 [00:03<00:07,  1.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.08it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
valid Loss: 0.67 Acc: 87.5 F1 : 0.79
Epoch 4/5

  1%|█▉                                                                                                                                                                                    | 3/276 [00:02<04:51,  1.07s/it]































 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 274/276 [01:04<00:00,  4.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.20it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 55%|████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                  | 11/20 [00:02<00:03,  2.54it/s]
valid Loss: 0.76 Acc: 87.4 F1 : 0.80
Epoch 5/5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.66it/s]
  0%|                                                                                                                                                                                              | 0/276 [00:00<?, ?it/s]
































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:04<00:00,  4.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 276/276 [01:05<00:00,  4.20it/s]
  0%|                                                                                                                                                                                               | 0/20 [00:00<?, ?it/s]

 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                             | 15/20 [00:03<00:01,  3.81it/s]
valid Loss: 0.68 Acc: 88.6 F1 : 0.81
==> best model saved - 5 / 88.6
Best valid Acc: 5 - 88.6
Best valid F1: 5 - 88.6

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:04<00:00,  4.32it/s]